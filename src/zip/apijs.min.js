/*!
 * Copyright 2008-2010 | Fabrice Creuzot (luigifab) <code~luigifab~fr>
 * https://www.luigifab.fr/apijs - 1.0.1
 * This program is free software, you can redistribute it or modify
 * it under the terms of the GNU General Public License (GPL).
 */
var i18n=null,TheButton=null,TheDialogue=null,TheSlideshow=null,TheUpload=null,TheMap=null,config={lang:"fr",debug:!0,debugkey:!1,navigator:!0,autolang:!0,dialogue:{blocks:[],hiddenPage:!1,resize:!0,autoplay:!0,savePhoto:!0,saveVideo:!0,videoWidth:640,videoHeight:480,imageClose:"./images/dialogue/close.png",imageUpload:"./images/dialogue/progressbar.svg",fileUpload:"./iframe.php",filePhoto:"./download.php",fileVideo:"./download.php"},slideshow:{ids:"diaporama",hoverload:!1},map:{width:580,height:400,initLatitude:1.9,initLongitude:46.3,imageMarker:"./images/map/marker.png",zoomInitial:5,zoomCenter:14,zoomSynchro:15}};function start(){for(var e=document.getElementsByTagName("a"),t=0;t<e.length;t++)config.navigator&&e[t].hasAttribute("class")&&e[t].getAttribute("class").match(/popup/)?e[t].addEventListener("click",openTab,!1):e[t].className.match(/popup/)&&e[t].setAttribute("onclick","window.open(this.href); return false;");"function"==typeof Internationalization&&"function"==typeof Dialogue&&((i18n=new Internationalization).init(),TheDialogue=new Dialogue,"function"==typeof Slideshow&&(config.dialogue.hiddenPage=!0,(TheSlideshow=new Slideshow).init()))}function openTab(e){e.preventDefault(),window.open(this.href)}function Internationalization(){this.i18n=new Array,this.i18n.de={buttonOk:"Okay",buttonCancel:"Stornieren",buttonConfirm:"Bestätigen",buttonClose:"",downloadLink:"",operationTooLong:"",reloadLink:"",warningLostChange:"",windowTooSmall:"",pressKeyF11:"",debugInvalidCall:"(debug) ",debugInvalidUse:"(debug) ",debugInvalidAltAttribute:"(debug) ",debugUnknownAction:"(debug) ",debugKeyDetected:"(debug) ",debugKeyCode:"",debugNotExist:"",debugNotRecognizedAltAttribute:""},this.i18n.en={buttonOk:"Ok",buttonCancel:"Cancel",buttonConfirm:"Confirm",buttonClose:"Close",downloadLink:"Download",operationTooLong:"This operation is too long ? ",reloadLink:"Reload this page",warningLostChange:"Warning : all changes in progress will be lost.",windowTooSmall:"Window too small",pressKeyF11:"Now press F11 to use full screen mode or enlarge the window.\n\nThe size of the window (§x§) is smaller than the required size (§x§), so it doesn't allow the display of the picture.",debugInvalidCall:"(debug) Invalid call",debugInvalidUse:"(debug) Invalid use",debugInvalidAltAttribute:"(debug) Invalid alt attribute",debugUnknownAction:"(debug) Unknown action",debugKeyDetected:"(debug) Key detected",debugKeyCode:"Code of the seizure key : ",debugNotExist:"doesn't exist (unlikely error).",debugNotRecognizedAltAttribute:"The alt attribute of the image wasn't recognized."},this.i18n.fr={buttonOk:"Ok",buttonCancel:"Annuler",buttonConfirm:"Valider",buttonClose:"Fermer",downloadLink:"Télécharger",operationTooLong:"Cette opération prend trop de temps ? ",reloadLink:"Rechargez la page",warningLostChange:"Attention : toutes les modifications en cours seront perdues.",windowTooSmall:"Fenêtre trop petite",pressKeyF11:"Appuyez maintenant sur F11 pour passer en mode plein écran, ou agrandissez la fenêtre.\n\nLa taille de la fenêtre (§x§) est inférieure à la taille requise (§x§) elle ne permet donc pas l'affichage de la photo.",debugInvalidCall:"(debug) Appel invalide",debugInvalidUse:"(debug) Utilisation invalide",debugInvalidAltAttribute:"(debug) Attribut alt invalide",debugUnknownAction:"(debug) Action inconnue",debugKeyDetected:"(debug) Touche détectée",debugKeyCode:"Code de la touche saisie : ",debugNotExist:"n'existe pas (erreur improbable).",debugNotRecognizedAltAttribute:"L'attribut alt de l'image n'a pas été reconnu."},this.init=function(){"string"==typeof navigator.language&&config.autolang&&navigator.language.slice(0,2)in this.i18n?config.lang=navigator.language.slice(0,2):"string"==typeof config.lang&&config.lang in this.i18n||(config.lang="en")},this.translate=function(e,t,i,n,l,o){if(1<arguments.length){var a,d=this.i18n[config.lang][e].split("§"),s="";for(a in d)d.hasOwnProperty(a)&&(s+=0<arguments.length?d[a]+shift(arguments):d[a]);return s}return this.i18n[config.lang][e]}}function Dialogue(){this.offset=0,this.timer=null,this.dialogue=null,this.image=null,this.elemA=null,this.elemB=null,this.elemC=null,this.elemD=null,this.dialogInformation=function(e,t,i){"string"==typeof e&&"string"==typeof t?(this.setupDialogue(i="string"!=typeof i?"information":i),this.htmlParent(),this.htmlTitle(e),this.htmlParagraph(t),this.htmlButtonOk()):config.debug&&this.dialogInformation(i18n.translate("debugInvalidCall"),"TheDialogue » dialogInformation\n➩ (string) title : "+e+"\n➩ (string) text : "+t+"\n➩ (string) icon : "+i)},this.dialogConfirmation=function(e,t,i,n){"string"==typeof e&&"string"==typeof t&&"string"==typeof i?(this.setupDialogue(n="string"!=typeof n?"confirmation":n),this.htmlParent(),this.htmlTitle(e),this.htmlParagraph(t),this.htmlButtonConfirm(i)):config.debug&&this.dialogInformation(i18n.translate("debugInvalidCall"),"TheDialogue » dialogConfirmation\n➩ (string) title : "+e+"\n➩ (string) text : "+t+"\n➩ (string) action : "+i+"\n➩ (string) icon : "+n)},this.dialogUpload=function(e,t,i,n){"string"==typeof e&&"string"==typeof t&&"string"==typeof n&&"string"==typeof i?(this.setupDialogue("upload"),this.htmlParent(),this.htmlTitle(e),this.htmlParagraph(t),this.htmlFormUpload(i,n),this.htmlButtonConfirm("upload")):config.debug&&this.dialogInformation(i18n.translate("debugInvalidCall"),"TheDialogue » dialogUpload\n➩ (string) title : "+e+"\n➩ (string) text : "+t+"\n➩ (string) data : "+i+"\n➩ (string) key : "+n)},this.dialogProgress=function(e,t){"string"==typeof e&&"string"==typeof t?(this.setupDialogue("progress"),this.htmlParent(),this.htmlTitle(e),this.htmlParagraph(t),this.htmlProgressBar(),this.timer=window.setTimeout(function(){TheDialogue.htmlLinkReload()},1e4)):config.debug&&this.dialogInformation(i18n.translate("debugInvalidCall"),"TheDialogue » dialogProgress\n➩ (string) title : "+e+"\n➩ (string) text : "+t)},this.dialogPleaseWait=function(e,t){"string"==typeof e&&"string"==typeof t?(this.setupDialogue("pleasewait"),this.htmlParent(),this.htmlTitle(e),this.htmlParagraph(t),this.timer=window.setTimeout(function(){TheDialogue.htmlLinkReload()},4e3)):config.debug&&this.dialogInformation(i18n.translate("debugInvalidCall"),"TheDialogue » dialogPleaseWait\n➩ (string) title : "+e+"\n➩ (string) text : "+t)},this.dialogPhoto=function(e,t,i,n,l){!config.dialogue.resize&&"string"==typeof e&&"string"==typeof t&&"string"==typeof i&&"number"==typeof n&&"number"==typeof l&&this.checkSize(n,l)?this.dialogInformation(i18n.translate("windowTooSmall"),i18n.translate("pressKeyF11",window.innerWidth,window.innerHeight,n+150,l+100),"window"):"string"==typeof e&&"string"==typeof t&&"string"==typeof i&&"number"==typeof n&&"number"==typeof l?(this.setupDialogue("photo"),this.htmlParent(),this.htmlPhoto(e,t,i,n,l),this.htmlButtonClose(),this.htmlButtonNavigation()):config.debug&&this.dialogInformation(i18n.translate("debugInvalidCall"),"TheDialogue » dialogPhoto\n➩ (string) date : "+e+"\n➩ (string) legend : "+t+"\n➩ (string) url : "+i+"\n➩ (number) width : "+n+"\n➩ (number) height : "+l)},this.dialogVideo=function(e,t,i){"string"==typeof t&&"string"==typeof i?(this.setupDialogue("video"),this.htmlParent(),this.htmlVideo(e,t,i),this.htmlButtonClose(),this.htmlButtonNavigation()):config.debug&&this.dialogInformation(i18n.translate("debugInvalidCall"),"TheDialogue » dialogVideo\n➩ (string) date : "+e+"\n➩ (string) legend : "+t+"\n➩ (string) url : "+i)},this.dialogAuto=function(e){"string"==typeof e&&document.getElementById(e)?(document.getElementById(e).setAttribute("class",document.getElementById(e).getAttribute("class").replace("nodisplay","dialogue")),document.getElementById(e+"Cancel").setAttribute("onclick","TheDialogue.actionClose();"),this.setupDialogue("auto "+e)):config.debug&&this.dialogInformation(i18n.translate("debugInvalidCall"),"TheDialogue » dialogAuto\n➩ (string) id : "+e)},this.actionExternal=function(e){e?(this.deleteDialogue(),this.showPage()):this.deleteDialogue()},this.actionClose=function(){this.deleteDialogue(),this.showPage()},this.actionOk=function(){this.deleteDialogue(),this.showPage()},this.actionCancel=function(){this.deleteDialogue(),this.showPage()},this.actionConfirm=function(e){"annuler"===e||"supprimer"===e?null!==TheButton&&"function"==typeof TheButton.actionConfir?TheButton.actionConfirm(e):config.debug&&this.dialogInformation(i18n.translate("debugInvalidUse"),"TheDialogue » actionConfirm\n➩ TheButton "+i18n.translate("debugNotExist")):"upload"===e?null!==TheUpload&&"function"==typeof TheUpload.actionConfir?TheUpload.actionConfirm():config.debug&&this.dialogInformation(i18n.translate("debugInvalidUse"),"TheDialogue » actionConfirm\n➩ TheUpload "+i18n.translate("debugNotExist")):config.debug&&this.dialogInformation(i18n.translate("debugUnknownAction"),"TheDialogue » actionConfirm\n➩ (string) action : "+e)},this.actionKey=function(e){config.debugkey?(e.preventDefault(),TheDialogue.dialogInformation(i18n.translate("debugKeyDetected"),"TheDialogue » actionKey\n"+i18n.translate("debugKeyCode")+e.keyCode)):27!==e.keyCode||"pleasewait"!==TheDialogue.dialogue&&"progress"!==TheDialogue.dialogue?27===e.keyCode?(e.preventDefault(),TheDialogue.actionClose()):122===e.keyCode&&"window"===TheDialogue.dialogue?TheDialogue.actionOk():35!==e.keyCode||"photo"!==TheDialogue.dialogue&&"video"!==TheDialogue.dialogue||null===TheSlideshow?36!==e.keyCode||"photo"!==TheDialogue.dialogue&&"video"!==TheDialogue.dialogue||null===TheSlideshow?37!==e.keyCode||"photo"!==TheDialogue.dialogue&&"video"!==TheDialogue.dialogue||null===TheSlideshow?39!==e.keyCode||"photo"!==TheDialogue.dialogue&&"video"!==TheDialogue.dialogue||null===TheSlideshow||(e.preventDefault(),TheSlideshow.actionNext()):(e.preventDefault(),TheSlideshow.actionPrevious()):(e.preventDefault(),TheSlideshow.actionFirst()):(e.preventDefault(),TheSlideshow.actionLast()):e.preventDefault()},this.setupDialogue=function(e){if(document.getElementById("dialogue")&&this.deleteDialogue(),config.dialogue.hiddenPage)for(var t in 0!==window.pageYOffset&&(this.offset=window.pageYOffset),config.dialogue.blocks)config.dialogue.blocks.hasOwnProperty(t)&&(document.getElementById(config.dialogue.blocks[t]).style.display="none");config.navigator&&document.addEventListener("keydown",TheDialogue.actionKey,!1),this.dialogue=e},this.deleteDialogue=function(){this.timer&&clearTimeout(this.timer),config.navigator&&document.removeEventListener("keydown",TheDialogue.actionKey,!1),this.dialogue.match(/auto/)?(document.getElementById(this.dialogue.slice(5)+"Cancel").removeAttribute("onclick"),document.getElementById(this.dialogue.slice(5)).setAttribute("class",document.getElementById(this.dialogue.slice(5)).getAttribute("class").replace("dialogue","nodisplay"))):document.getElementById("dialogue").parentNode.removeChild(document.getElementById("dialogue")),this.timer=null,this.dialogue=null,this.image=null,this.elemA=null,this.elemB=null,this.elemC=null,this.elemD=null},this.showPage=function(){if(document.getElementById("iframe_upload")&&document.getElementById("iframe_upload").parentNode.removeChild(document.getElementById("iframe_upload")),config.dialogue.hiddenPage){for(var e in config.dialogue.blocks)config.dialogue.blocks.hasOwnProperty(e)&&(document.getElementById(config.dialogue.blocks[e]).style.display="block");window.scrollBy(0,this.offset)}},this.checkSize=function(e,t){return e>window.innerWidth-150||t>window.innerHeight-100},this.htmlParent=function(){this.elemA=document.createElement("div"),this.elemA.setAttribute("id","dialogue"),document.getElementsByTagName("body")[0].appendChild(this.elemA),this.elemA=document.createElement("div"),this.elemA.setAttribute("id","boite"),this.elemA.setAttribute("class",this.dialogue),document.getElementById("dialogue").appendChild(this.elemA)},this.htmlTitle=function(e){this.elemA=document.createElement("h1"),this.elemA.appendChild(document.createTextNode(e)),document.getElementById("boite").appendChild(this.elemA)},this.htmlParagraph=function(e){if(this.elemA=document.createElement("p"),0<e.search(/\n/)){e=e.split("\n"),this.elemA.appendChild(document.createTextNode(e[0]));for(var t=1;t<e.length;t++)this.elemA.appendChild(document.createElement("br")),this.elemA.appendChild(document.createTextNode(e[t]))}else this.elemA.appendChild(document.createTextNode(e));document.getElementById("boite").appendChild(this.elemA)},this.htmlButtonOk=function(){this.elemA=document.createElement("div"),this.elemA.setAttribute("class","control"),this.elemB=document.createElement("button"),this.elemB.setAttribute("type","button"),this.elemB.setAttribute("class","confirm"),this.elemB.setAttribute("onclick","TheDialogue.actionOk();"),this.elemB.appendChild(document.createTextNode(i18n.translate("buttonOk"))),this.elemA.appendChild(this.elemB),document.getElementById("boite").appendChild(this.elemA),document.getElementById("boite").lastChild.lastChild.focus()},this.htmlButtonConfirm=function(e){this.elemA=document.createElement("div"),this.elemA.setAttribute("class","control"),this.elemB=document.createElement("button"),this.elemB.setAttribute("type","button"),this.elemB.setAttribute("class","cancel"),this.elemB.setAttribute("onclick","TheDialogue.actionCancel();"),this.elemB.appendChild(document.createTextNode(i18n.translate("buttonCancel"))),this.elemA.appendChild(this.elemB),this.elemB=document.createElement("button"),this.elemB.setAttribute("type","button"),this.elemB.setAttribute("class","confirm"),this.elemB.setAttribute("onclick","TheDialogue.actionConfirm('"+e+"');"),this.elemB.appendChild(document.createTextNode(i18n.translate("buttonConfirm"))),this.elemA.appendChild(this.elemB),document.getElementById("boite").appendChild(this.elemA),(document.getElementById("form_upload")?document.getElementById("form_upload").firstChild.firstChild:document.getElementById("boite").lastChild.lastChild).focus()},this.htmlButtonNavigation=function(){this.elemA=document.createElement("div"),this.elemA.setAttribute("class","navigation"),this.elemB=document.createElement("button"),this.elemB.setAttribute("type","button"),this.elemB.setAttribute("id","previous"),this.elemB.setAttribute("disabled","disabled"),this.elemB.setAttribute("onclick","TheSlideshow.actionPrevious();"),this.elemB.appendChild(document.createTextNode("«")),this.elemA.appendChild(this.elemB),this.elemB=document.createElement("button"),this.elemB.setAttribute("type","button"),this.elemB.setAttribute("id","next"),this.elemB.setAttribute("disabled","disabled"),this.elemB.setAttribute("onclick","TheSlideshow.actionNext();"),this.elemB.appendChild(document.createTextNode("»")),this.elemA.appendChild(this.elemB),document.getElementById("boite").appendChild(this.elemA)},this.htmlButtonClose=function(){this.elemA=document.createElement("div"),this.elemA.setAttribute("class","close"),this.elemB=document.createElement("button"),this.elemB.setAttribute("type","button"),this.elemB.setAttribute("class","close"),this.elemB.setAttribute("onclick","TheDialogue.actionClose();"),this.elemC=document.createElement("img"),this.elemC.setAttribute("src",config.dialogue.imageClose),this.elemC.setAttribute("width","60"),this.elemC.setAttribute("height","22"),this.elemC.setAttribute("alt",i18n.translate("buttonClose")),this.elemB.appendChild(this.elemC),this.elemA.appendChild(this.elemB),document.getElementById("boite").appendChild(this.elemA)},this.htmlLinkReload=function(){this.elemA=document.createElement("p"),this.elemA.setAttribute("class","reload"),this.elemA.appendChild(document.createTextNode(i18n.translate("operationTooLong"))),this.elemB=document.createElement("a"),this.elemB.setAttribute("href",document.URL),this.elemB.appendChild(document.createTextNode(i18n.translate("reloadLink"))),this.elemA.appendChild(this.elemB),this.elemA.appendChild(document.createTextNode(".")),this.elemB=document.createElement("br"),this.elemA.appendChild(this.elemB),this.elemA.appendChild(document.createTextNode(i18n.translate("warningLostChange"))),document.getElementById("boite").appendChild(this.elemA)},this.htmlFormUpload=function(e,t){this.elemA=document.createElement("iframe"),this.elemA.setAttribute("id","iframe_upload"),this.elemA.setAttribute("name","iframe_upload_"+t),this.elemA.setAttribute("src",config.dialogue.imageUpload),document.getElementsByTagName("body")[0].appendChild(this.elemA),this.elemA=document.createElement("form"),this.elemA.setAttribute("id","form_upload"),this.elemA.setAttribute("action",config.dialogue.fileUpload),this.elemA.setAttribute("method","post"),this.elemA.setAttribute("enctype","multipart/form-data"),this.elemA.setAttribute("target","iframe_upload_"+t),this.elemB=document.createElement("p"),this.elemC=document.createElement("input"),this.elemC.setAttribute("type","file"),this.elemC.setAttribute("name",e),this.elemC.setAttribute("onchange","document.getElementById('boite').lastChild.lastChild.focus();"),this.elemB.appendChild(this.elemC),this.elemC=document.createElement("input"),this.elemC.setAttribute("type","hidden"),this.elemC.setAttribute("name","APC_UPLOAD_PROGRESS"),this.elemC.setAttribute("value",t),this.elemB.appendChild(this.elemC),this.elemA.appendChild(this.elemB),document.getElementById("boite").appendChild(this.elemA)},this.htmlProgressBar=function(){this.elemA=document.createElement("object"),this.elemA.setAttribute("id","progressbar"),this.elemA.setAttribute("type","image/svg+xml"),this.elemA.setAttribute("data",config.dialogue.imageUpload),this.elemA.setAttribute("width","300"),this.elemA.setAttribute("height","17"),document.getElementById("boite").appendChild(this.elemA)},this.htmlPhoto=function(e,t,i,n,l){var o={width:n,height:l,name:i.slice(i.lastIndexOf("/")+1,i.lastIndexOf("."))},a={width:window.innerWidth,height:window.innerHeight};config.dialogue.resize&&this.checkSize(n,l)&&(a.width-=150,a.height-=100,o.width>a.width?(o.height=Math.round(o.height*(a.width/o.width)),o.width=a.width,o.height>a.height&&(o.width=Math.round(o.width*(a.height/o.height)),o.height=a.height)):o.height>a.height&&(o.width=Math.round(o.width*(a.height/o.height)),o.height=a.height,o.width>a.width&&(o.height=Math.round(o.height*(a.width/o.width)),o.width=a.width))),document.getElementById("boite").style.width=o.width+"px",document.getElementById("boite").style.marginLeft=parseInt(-(o.width+20)/2,10)+"px",document.getElementById("boite").style.marginTop=parseInt(-(o.height+50)/2,10)+"px",this.elemA=document.createElement("dl"),this.elemB=document.createElement("dt"),config.dialogue.resize&&this.checkSize(n,l)?(this.elemC=document.createElement("a"),this.elemC.setAttribute("href",i),this.elemC.setAttribute("onclick","window.open(this.href); this.blur(); return false;"),this.elemD=document.createElement("img"),this.elemD.setAttribute("id","photo"),this.elemD.setAttribute("class","loading resized"),this.elemD.setAttribute("width",o.width),this.elemD.setAttribute("height",o.height),this.elemC.appendChild(this.elemD),this.elemC.appendChild(document.createElement("span"))):(this.elemC=document.createElement("img"),this.elemC.setAttribute("id","photo"),this.elemC.setAttribute("class","loading"),this.elemC.setAttribute("width",o.width),this.elemC.setAttribute("height",o.height)),this.elemB.appendChild(this.elemC),this.elemA.appendChild(this.elemB),this.elemB=document.createElement("dd"),"§"!==e&&(this.elemC=document.createElement("span"),this.elemC.appendChild(document.createTextNode(o.name+" ("+e+")")),this.elemB.appendChild(this.elemC)),this.elemB.appendChild(document.createTextNode(" "+t+" ")),config.dialogue.savePhoto&&(this.elemC=document.createElement("a"),this.elemC.setAttribute("href",config.dialogue.filePhoto+"?id="+o.name),this.elemC.setAttribute("class","download"),this.elemC.appendChild(document.createTextNode(i18n.translate("downloadLink"))),this.elemB.appendChild(this.elemC)),this.elemA.appendChild(this.elemB),document.getElementById("boite").appendChild(this.elemA),config.navigator?(this.image=new Image(n,l),this.image.src=i,this.image.addEventListener("load",function(){document.getElementById("photo")&&(document.getElementById("photo").removeAttribute("class"),document.getElementById("photo").setAttribute("src",TheDialogue.image.src))},!1),this.image.addEventListener("error",function(){var e;document.getElementById("photo")&&(config.dialogue.resize&&document.getElementById("photo").getAttribute("class").match(/resized/)&&(e=document.getElementById("photo").cloneNode(!0),document.getElementById("photo").parentNode.parentNode.removeChild(document.getElementById("photo").parentNode),document.getElementById("boite").firstChild.firstChild.appendChild(e)),config.dialogue.savePhoto&&document.getElementById("boite").firstChild.lastChild.removeChild(document.getElementById("boite").firstChild.lastChild.lastChild),document.getElementById("photo").setAttribute("class","onerror_"+config.lang))},!1)):(document.getElementById("photo").removeAttribute("class"),document.getElementById("photo").setAttribute("src",i))},this.htmlVideo=function(e,t,i){this.elemA=document.createElement("dl"),this.elemB=document.createElement("dt"),this.elemC=document.createElement("video"),this.elemC.setAttribute("src",i),this.elemC.setAttribute("width",config.dialogue.videoWidth),this.elemC.setAttribute("height",config.dialogue.videoHeight),this.elemC.setAttribute("controls","controls"),config.dialogue.autoplay&&this.elemC.setAttribute("autoplay","autoplay"),this.elemB.appendChild(this.elemC),this.elemA.appendChild(this.elemB),this.elemB=document.createElement("dd"),"§"!==e&&(this.elemC=document.createElement("span"),this.elemC.appendChild(document.createTextNode("("+e+")")),this.elemB.appendChild(this.elemC)),this.elemB.appendChild(document.createTextNode(" "+t+" ")),config.dialogue.saveVideo&&(i=i.slice(i.lastIndexOf("/")+1,i.lastIndexOf(".")),this.elemC=document.createElement("a"),this.elemC.setAttribute("href",config.dialogue.fileVideo+"?id="+i),this.elemC.setAttribute("class","download"),this.elemC.appendChild(document.createTextNode(i18n.translate("downloadLink"))),this.elemB.appendChild(this.elemC)),this.elemA.appendChild(this.elemB),document.getElementById("boite").appendChild(this.elemA)}}function Slideshow(){this.media=null,this.totals=null,this.presentation=null,this.init=function(){this.media={album:null,number:null,first:null,prev:null,next:null,last:null},this.totals=[],this.presentation=[];for(var e=null,t=0,i=0;null!==document.getElementById(config.slideshow.ids+"."+t);t++)for(e=config.slideshow.ids+"."+t+".999",this.presentation[t]=!!document.getElementById(e)&&0,document.getElementById(e)&&(config.navigator?document.getElementById(e).addEventListener("click",TheSlideshow.showMedia,!1):document.getElementById(e).setAttribute("onclick","TheSlideshow.showMedia(this.getAttribute('id')); return false;")),i=0;null!==document.getElementById(config.slideshow.ids+"."+t+"."+i);i++)e=config.slideshow.ids+"."+t+"."+i,config.navigator?config.slideshow.hoverload&&!1!==this.presentation[t]?(document.getElementById(e).addEventListener("click",TheSlideshow.showMedia,!1),document.getElementById(e).addEventListener("mouseover",TheSlideshow.showMedia,!1)):document.getElementById(e).addEventListener("click",TheSlideshow.showMedia,!1):config.slideshow.hoverload&&!1!==this.presentation[t]?(document.getElementById(e).setAttribute("onclick","TheSlideshow.showMedia(this.getAttribute('id')); return false;"),document.getElementById(e).setAttribute("onmouseover","TheSlideshow.showMedia(this.getAttribute('id')); return false;")):document.getElementById(e).setAttribute("onclick","TheSlideshow.showMedia(this.getAttribute('id')); return false;"),this.totals[t]=i},this.showMedia=function(e){var t={id:null,url:null,alt:null,num:0,date:null,legend:null,width:null,height:null},i=null,i=("string"!=typeof e?(e.preventDefault(),t.id=this.getAttribute("id"),t.url=this.getAttribute("href"),t.alt=this.firstChild.getAttribute("alt").split("|")):(t.id=e,t.url=document.getElementById(t.id).getAttribute("href"),t.alt=document.getElementById(t.id).firstChild.getAttribute("alt").split("|")),t.id.split("."));if(t.album=parseInt(i[1],10),t.number=parseInt(i[2],10),!1!==TheSlideshow.presentation[t.album]&&(1<t.alt.length||t.alt.length<6)){if("string"!=typeof e){if(config.navigator&&this.firstChild.hasAttribute("class"))return;if(!config.navigator&&""!==this.firstChild.className)return}null!==TheDialogue.dialogue||5!==t.alt.length&&3!==t.alt.length?(null!==TheDialogue.dialogue||4!==t.alt.length&&2!==t.alt.length?TheSlideshow.updatePresentation(t):t.number=TheSlideshow.presentation[t.album],TheSlideshow.showDialogue(t)):TheSlideshow.updatePresentation(t)}else 4===t.alt.length||2===t.alt.length?TheSlideshow.showDialogue(t):config.debug&&TheDialogue.dialogInformation(i18n.translate("debugInvalidUse"),"TheSlideshow » showMedia\n"+i18n.translate("debugNotRecognizedAltAttribute"))},this.updatePresentation=function(e){var t=null,i=null,n=0;if(5===e.alt.length&&0<e.alt[0].length&&0<e.alt[1].length&&0<e.alt[2].length&&0<e.alt[3].length){for(t=config.slideshow.ids+"."+e.album,document.getElementById(t+".999").setAttribute("href",document.getElementById(e.id).getAttribute("href")),document.getElementById(t+".999").firstChild.setAttribute("src",e.alt.shift()),document.getElementById(t+".999").firstChild.setAttribute("alt",e.alt.join("|")),i=document.getElementById(t).getElementsByTagName("img"),n=0;n<i.length;n++)config.navigator&&i[n].hasAttribute("class")&&"actif"===i[n].getAttribute("class")?i[n].removeAttribute("class"):"actif"===i[n].className&&(i[n].className="");document.getElementById(e.id).firstChild.setAttribute("class","actif"),this.presentation[e.album]=e.number}else if(config.debug&&5===e.alt.length)TheDialogue.dialogInformation(i18n.translate("debugInvalidAltAttribute"),"TheSlideshow » changePhoto\n➩ (string) url : "+e.alt[0]+"\n➩ (number) width : "+e.alt[1]+"\n➩ (number) height : "+e.alt[2]+"\n➩ (string) date : "+e.alt[3]+"\n➩ (string) legend : "+e.alt[4]);else if(3===e.alt.length&&0<e.alt[0].length&&0<e.alt[1].length){for(t=config.slideshow.ids+"."+e.album,document.getElementById(t+".999").setAttribute("href",document.getElementById(e.id).getAttribute("href")),document.getElementById(t+".999").firstChild.setAttribute("src",e.alt.shift()),document.getElementById(t+".999").firstChild.setAttribute("alt",e.alt.join("|")),i=document.getElementById(t).getElementsByTagName("img"),n=0;n<i.length;n++)config.navigator&&i[n].hasAttribute("class")&&"actif"===i[n].getAttribute("class")?i[n].removeAttribute("class"):"actif"===i[n].className&&(i[n].className="");document.getElementById(e.id).firstChild.setAttribute("class","actif"),this.presentation[e.album]=e.number}else config.debug&&3===e.alt.length&&TheDialogue.dialogInformation(i18n.translate("debugInvalidAltAttribute"),"TheSlideshow » changePhoto\n➩ (string) url : "+e.alt[0]+"\n➩ (string) date : "+e.alt[1]+"\n➩ (string) legend : "+e.alt[2])},this.showDialogue=function(e){4===e.alt.length&&0<e.alt[0].length&&0<e.alt[1].length&&0<e.alt[2].length?(e.date=e.alt[2],e.legend=e.alt[3],e.width=parseInt(e.alt[0],10),e.height=parseInt(e.alt[1],10),null!==TheDialogue.dialogue&&TheDialogue.actionExternal(!1),TheDialogue.dialogPhoto(e.date,e.legend,e.url,e.width,e.height),this.showNavigation(e.album,e.number),(config.navigator&&config.dialogue.hiddenPage&&"photo"===TheDialogue.dialogue&&!document.getElementById("dialogue").hasAttribute("class")||config.dialogue.hiddenPage&&"photo"===TheDialogue.dialogue&&"norgba"!==document.getElementById("dialogue").className)&&document.getElementById("dialogue").setAttribute("class","norgba")):config.debug&&4===e.alt.length?TheDialogue.dialogInformation(i18n.translate("debugInvalidAltAttribute"),"TheSlideshow » showMedia\n➩ (number) width : "+e.alt[0]+"\n➩ (number) height : "+e.alt[1]+"\n➩ (string) date : "+e.alt[2]+"\n➩ (string) legend : "+e.alt[3]):2===e.alt.length&&0<e.alt[0].length?(e.date=e.alt[0],e.legend=e.alt[1],null!==TheDialogue.dialogue&&TheDialogue.actionExternal(!1),TheDialogue.dialogVideo(e.date,e.legend,e.url),this.showNavigation(e.album,e.number),(config.navigator&&config.dialogue.hiddenPage&&"video"===TheDialogue.dialogue&&!document.getElementById("dialogue").hasAttribute("class")||config.dialogue.hiddenPage&&"video"===TheDialogue.dialogue&&"norgba"!==document.getElementById("dialogue").className)&&document.getElementById("dialogue").setAttribute("class","norgba")):config.debug&&2===e.alt.length&&TheDialogue.dialogInformation(i18n.translate("debugInvalidAltAttribute"),"TheSlideshow » showMedia\n➩ (string) date : "+e.alt[0]+"\n➩ (string) legend : "+e.alt[1])},this.showNavigation=function(e,t){"photo"!==TheDialogue.dialogue&&"video"!==TheDialogue.dialogue||(this.media.album=e,this.media.number=t,this.media.first=config.slideshow.ids+"."+this.media.album+".0",this.media.prev=config.slideshow.ids+"."+this.media.album+"."+(this.media.number-1),this.media.next=config.slideshow.ids+"."+this.media.album+"."+(this.media.number+1),this.media.last=config.slideshow.ids+"."+this.media.album+"."+this.totals[this.media.album],document.getElementById(this.media.prev)?document.getElementById("previous").removeAttribute("disabled"):this.media.prev=null,document.getElementById(this.media.next)?document.getElementById("next").removeAttribute("disabled"):this.media.next=null)},this.actionFirst=function(){null!==this.media&&0<this.media.number&&this.media.number<=this.totals[this.media.album]&&this.showMedia(this.media.first)},this.actionPrevious=function(){null!==this.media&&null!==this.media.prev&&0<this.media.number&&this.showMedia(this.media.prev)},this.actionNext=function(){null!==this.media&&null!==this.media.next&&this.media.number<this.totals[this.media.album]&&this.showMedia(this.media.next)},this.actionLast=function(){null!==this.media&&0<=this.media.number&&this.media.number<this.totals[this.media.album]&&this.showMedia(this.media.last)}}navigator.userAgent.match(/MSIE/)?(config.navigator=!1,window.innerWidth=document.documentElement.clientWidth,window.innerHeight=document.documentElement.clientHeight,window.onload=start):window.addEventListener("load",start,!1);